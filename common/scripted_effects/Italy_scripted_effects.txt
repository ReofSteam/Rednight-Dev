ITA_italy_join_with_confed = {
	every_owned_state = {
		limit = {
			NOT = {
				state = 159 #Lombardia
				state = 783 #Trentino
				state = 39 #Southern Tyrol
				state = 759 #Friuli
				state = 160 #Venetia
				state = 736 #Austrian Littoral
			}
		}
		ROOT = { transfer_state = PREV }
	}

	hidden_effect = {
		every_country = {
			limit = { is_subject_of = PREV }
			overlord = {
				set_autonomy = { target = PREV autonomy_state = autonomy_free }
			}
			if = {
				limit = { is_italian_tag = yes }
				ITA_notitaly_join_with_confed = yes
			}
			else_if = {
				limit = { is_italian_tag = no }
				if = {
					limit = {
						is_in_faction = yes
						NOT = { is_in_faction_with = ROOT }
					}
					leave_faction = yes
				}
				if = {
					limit = {
						has_war = yes
						NOT = { is_in_faction_with = ROOT }
					}
					separate_peace_all_wars = yes
				}
				get_current_government_type = yes
				ROOT = { puppet = PREV }
				restore_previous_government_type = yes
			}
		}

		every_state = {
			limit = {
				OR = {
					is_core_of = ITA
					is_claimed_by = ITA
				}
			}
			remove_core_of = ITA
			remove_claim_by = ITA
		}
		159 = { add_core_of = LOM }
		160 = { add_core_of = VNC }
		759 = {
			if = {
				limit = { NOT = { is_core_of = VNC } }
				add_claim_by = VNC
			}
		}
	}

	if = {
		limit = {
			owns_state = 159
			owns_state = 160
		}
		every_owned_state = {
			limit = {
				OR = {
					state = 759 #Friuli
					state = 160 #Venetia
					state = 736 #Austrian Littoral
				}
			}
			VNC = { transfer_state = PREV }
		}
		VNC = {
			transfer_technology = yes
			ITA_notitaly_join_with_confed = yes
		}
		transfer_navy = { target = VNC }
		LOM = {
			annex_country = { target = ITA transfer_troops = yes }
			transfer_technology = yes
			ITA_notitaly_join_with_confed = yes
		}
		if = {
			limit = { ITA = { is_ai = no } }
			LOM = { change_tag_from = ITA }
		}
	}
	else_if = {
		limit = { owns_state = 159 }
		every_owned_state = {
			limit = {
				OR = {
					state = 759 #Friuli
					state = 736 #Austrian Littoral
				}
			}
			ROOT = { transfer_state = PREV }
		}
		LOM = {
			annex_country = { target = ITA transfer_troops = yes }
			transfer_technology = yes
			ITA_notitaly_join_with_confed = yes
		}
		if = {
			limit = { ITA = { is_ai = no } }
			LOM = { change_tag_from = ITA }
		}
	}
	else_if = {
		limit = { owns_state = 160 }
		VNC = {
			annex_country = { target = ITA transfer_troops = yes }
			transfer_technology = yes
			ITA_notitaly_join_with_confed = yes
		}
		if = {
			limit = { ITA = { is_ai = no } }
			VNC = { change_tag_from = ITA }
		}
	}
}

ITA_notitaly_join_with_confed = {
	if = {
		limit = { tag = SRD }
		every_state = {
			limit = {
				OR = {
					is_owned_by = ROOT
					owner = { is_subject_of = ROOT }
				}
				OR = {
					state = 1003 #Aosta Valley
					state = 158 #Piedmont
					state = 838 #Liguria
					state = 762 #Nice
					state = 735 #Savoy
					state = 943 #Upper Savoy
					state = 1002 #Sassari
					state = 114 #Cagliari
				}
			}
			PREV = { transfer_state = PREV }
		}
		every_owned_state = {
			limit = {
				NOT = {
					state = 1003 #Aosta Valley
					state = 158 #Piedmont
					state = 838 #Liguria
					state = 762 #Nice
					state = 735 #Savoy
					state = 943 #Upper Savoy
					state = 1002 #Sassari
					state = 114 #Cagliari
				}
			}
			ROOT = { transfer_state = PREV }
		}
		drop_cosmetic_tag = yes
		if = {
			limit = { owns_state = 158 }
			set_cosmetic_tag = SRD_piedmont
		}
	}
	else_if = {
		limit = { tag = PAP }
		every_state = {
			limit = {
				OR = {
					is_owned_by = ROOT
					owner = { is_subject_of = ROOT }
				}
				OR = {
					state = 2 #Latium
					state = 764 #Viterbo
					state = 1005 #Umbria
					state = 157 #Marches
					state = 161 #Romagna
				}
			}
			PREV = { transfer_state = PREV }
		}
		every_owned_state = {
			limit = {
				NOT = {
					state = 2 #Latium
					state = 764 #Viterbo
					state = 1005 #Umbria
					state = 157 #Marches
					state = 161 #Romagna
				}
			}
			ROOT = { transfer_state = PREV }
		}
	}
	else_if = {
		limit = { tag = SIC }
		every_state = {
			limit = {
				OR = {
					is_owned_by = ROOT
					owner = { is_subject_of = ROOT }
				}
				OR = {
					state = 117 #Campania
					state = 742 #Abruzzo
					state = 837 #Apulia
					state = 1006 #Basilicata
					state = 156 #Calabria
					state = 115 #Sicily
				}
			}
			PREV = { transfer_state = PREV }
		}
		every_owned_state = {
			limit = {
				NOT = {
					state = 117 #Campania
					state = 742 #Abruzzo
					state = 837 #Apulia
					state = 1006 #Basilicata
					state = 156 #Calabria
					state = 115 #Sicily
				}
			}
			ROOT = { transfer_state = PREV }
		}
		drop_cosmetic_tag = yes
	}
	else_if = {
		limit = { tag = VNC }
		every_state = {
			limit = {
				OR = {
					is_owned_by = ROOT
					owner = { is_subject_of = ROOT }
				}
				OR = {
					state = 759 #Friuli
					state = 160 #Venetia
					state = 736 #Austrian Littoral
				}
			}
			PREV = { transfer_state = PREV }
		}
		every_owned_state = {
			limit = {
				NOT = {
					state = 759 #Friuli
					state = 160 #Venetia
					state = 736 #Austrian Littoral
				}
			}
			ROOT = { transfer_state = PREV }
		}
	}
	else_if = {
		limit = { tag = LOM }
		every_state = {
			limit = {
				OR = {
					is_owned_by = ROOT
					owner = { is_subject_of = ROOT }
				}
				OR = {
					state = 159 #Lombardia
					state = 783 #Trentino
					state = 39 #Southern Tyrol
				}
			}
			PREV = { transfer_state = PREV }
		}
		every_owned_state = {
			limit = {
				NOT = {
					state = 159 #Lombardia
					state = 783 #Trentino
					state = 39 #Southern Tyrol
				}
			}
			ROOT = { transfer_state = PREV }
		}
	}
	else_if = {
		limit = { tag = EMI }
		every_owned_state = {
			limit = {
				NOT = {
					state = 1004 #Emilia
				}
			}
			ROOT = { transfer_state = PREV }
		}
	}
	else_if = {
		limit = { tag = TUS }
		every_owned_state = {
			limit = {
				NOT = {
					state = 162 #Tuscany
				}
			}
			ROOT = { transfer_state = PREV }
		}
	}

	if = {
		limit = {
			is_in_faction = yes
			NOT = { is_in_faction_with = ROOT }
		}
		leave_faction = yes
	}
	if = {
		limit = {
			has_war = yes
			NOT = { is_in_faction_with = ROOT }
		}
		separate_peace_all_wars = yes
	}

	hidden_effect = {
		every_country = {
			limit = { is_subject_of = PREV }
			overlord = {
				set_autonomy = { target = PREV autonomy_state = autonomy_free }
			}
			if = {
				limit = { is_italian_tag = yes }
				ITA_notitaly_join_with_confed = yes
			}
			else_if = {
				limit = { is_italian_tag = no }
				if = {
					limit = {
						is_in_faction = yes
						NOT = { is_in_faction_with = ROOT }
					}
					leave_faction = yes
				}
				get_current_government_type = yes
				ROOT = { puppet = PREV }
				restore_previous_government_type = yes
			}
		}
	}

	if = {
		limit = { ROOT = { is_faction_leader = yes } }
		ROOT = { add_to_faction = PREV }
	}

	get_current_government_type = yes
	ROOT = {
		set_autonomy = {
			target = PREV
			autonomy_state = kr_autonomous_puppet
		}
	}
	restore_previous_government_type = yes
}

ITA_join_with_empire = {
	hidden_effect = {
		every_country = {
			limit = { is_subject_of = PREV }
			overlord = {
				set_autonomy = { target = PREV autonomy_state = autonomy_free }
			}
			if = {
				limit = { is_italian_tag = yes }
				ITA_join_with_empire = yes
			}
			else_if = {
				limit = { is_italian_tag = no }
				if = {
					limit = {
						is_in_faction = yes
						NOT = { is_in_faction_with = ROOT }
					}
					leave_faction = yes
				}
				if = {
					limit = {
						has_war = yes
						NOT = { is_in_faction_with = ROOT }
					}
					separate_peace_all_wars = yes
				}
				get_current_government_type = yes
				ROOT = { puppet = PREV }
				restore_previous_government_type = yes
			}
		}
	}

	every_state = {
		limit = { is_claim_or_core_of_PREV = yes }
		if = {
			limit = {
				is_core_of = PREV
				NOT = { is_core_of = ROOT }
			}
			hidden_effect = { remove_claim_by = ROOT }
			add_core_of = ROOT
		}
		hidden_effect = {
			if = {
				limit = { is_core_of = PREV }
				remove_core_of = PREV
			}
			if = {
				limit = { is_claimed_by = PREV }
				remove_claim_by = PREV
			}
		}
	}

	transfer_navy = { target = ROOT }
	ROOT = {
		annex_country = { target = PREV transfer_troops = yes }
	}

	if = {
		limit = {
			is_ai = no
			ROOT = { is_ai = yes }
		}
		ROOT = { change_tag_from = PREV }
	}
}

ITA_turn_on_ita_ministers = {
	clr_country_flag = Carlo_Rosselli_dead
	clr_country_flag = Paolo_Treves_dead
	clr_country_flag = Ferruccio_Parri_dead
	clr_country_flag = Duccio_Galimberti_dead
	clr_country_flag = Mario_Bracci_dead
	clr_country_flag = Giovanni_Malagodi_dead
	clr_country_flag = Nicolo_Carandini_dead
	clr_country_flag = Giovanni_Gronchi_dead
	clr_country_flag = Giovanni_Uberti_dead
	clr_country_flag = Giovanni_Battista_Bertone_dead
	clr_country_flag = Italo_Balbo_dead
	clr_country_flag = Rodolfo_Graziani_dead
	clr_country_flag = Raffaele_de_Courten_dead
	clr_country_flag = Alessandro_Pavolini_dead
	clr_country_flag = Giovanni_Host_Venturi_dead
	clr_country_flag = Agostino_Rocca_dead
	clr_country_flag = Stefano_Cavazzoni_dead
}

ITA_turn_off_ita_ministers = {
	set_country_flag = Carlo_Rosselli_dead
	set_country_flag = Paolo_Treves_dead
	set_country_flag = Ferruccio_Parri_dead
	set_country_flag = Duccio_Galimberti_dead
	set_country_flag = Mario_Bracci_dead
	set_country_flag = Giovanni_Malagodi_dead
	set_country_flag = Nicolo_Carandini_dead
	set_country_flag = Giovanni_Gronchi_dead
	set_country_flag = Giovanni_Uberti_dead
	set_country_flag = Giovanni_Battista_Bertone_dead
	set_country_flag = Italo_Balbo_dead
	set_country_flag = Rodolfo_Graziani_dead
	set_country_flag = Raffaele_de_Courten_dead
	set_country_flag = Alessandro_Pavolini_dead
	set_country_flag = Giovanni_Host_Venturi_dead
	set_country_flag = Agostino_Rocca_dead
	set_country_flag = Stefano_Cavazzoni_dead
}

ITA_turn_on_sic_ministers = {
	clr_country_flag = Enrico_De_Nicola_dead
	clr_country_flag = Renato_Morelli_dead
	clr_country_flag = Mario_Scelba_dead
	clr_country_flag = Ernesto_Vassallo_dead
	clr_country_flag = Ugo_La_Malfa_dead
	clr_country_flag = Roberto_Lucifero_d'Aprigliano_dead
	clr_country_flag = Enrico_Mole_dead
	clr_country_flag = Achille_Starace_dead
	clr_country_flag = Filippo_Anfuso_dead
	clr_country_flag = Vincenzo_Azzolini_dead
	clr_country_flag = Giovanni_Messe_dead
	clr_country_flag = Ettore_Baldassarre_dead
	clr_country_flag = Fulco_Ruffo_di_Calabria_dead
	clr_country_flag = Luigi_Rizzo_dead
}

ITA_turn_off_sic_ministers = {
	set_country_flag = Enrico_De_Nicola_dead
	set_country_flag = Renato_Morelli_dead
	set_country_flag = Mario_Scelba_dead
	set_country_flag = Ernesto_Vassallo_dead
	set_country_flag = Ugo_La_Malfa_dead
	set_country_flag = Roberto_Lucifero_d'Aprigliano_dead
	set_country_flag = Enrico_Mole_dead
	set_country_flag = Achille_Starace_dead
	set_country_flag = Filippo_Anfuso_dead
	set_country_flag = Vincenzo_Azzolini_dead
	set_country_flag = Giovanni_Messe_dead
	set_country_flag = Ettore_Baldassarre_dead
	set_country_flag = Fulco_Ruffo_di_Calabria_dead
	set_country_flag = Luigi_Rizzo_dead
}

ITA_turn_on_srd_ministers = {
	clr_country_flag = Mario_Berlinguer_dead
	clr_country_flag = Anselmo_Contu_dead
	clr_country_flag = Alfredo_Corrias_dead
	clr_country_flag = Giuseppe_Brotzu_dead
	clr_country_flag = Filiberto_di_Savoia_Genova_dead
	clr_country_flag = Vittorio_Ambrosio_dead
	clr_country_flag = Raffaele_Paolucci_dead
	clr_country_flag = Ugo_Cavallero_dead
	clr_country_flag = Giuseppe_Musinu_dead
	clr_country_flag = Rino_Corso_Fougier_dead
	clr_country_flag = Angelo_Iachino_dead
}

ITA_turn_off_srd_ministers = {
	set_country_flag = Mario_Berlinguer_dead
	set_country_flag = Anselmo_Contu_dead
	set_country_flag = Alfredo_Corrias_dead
	set_country_flag = Giuseppe_Brotzu_dead
	set_country_flag = Filiberto_di_Savoia_Genova_dead
	set_country_flag = Vittorio_Ambrosio_dead
	set_country_flag = Raffaele_Paolucci_dead
	set_country_flag = Ugo_Cavallero_dead
	set_country_flag = Giuseppe_Musinu_dead
	set_country_flag = Rino_Corso_Fougier_dead
	set_country_flag = Angelo_Iachino_dead
}

SRI_next_neosanfedisti_attack = {
	hidden_effect = {
		if = {
			limit = { has_idea = SRI_neosanfedisti_1 }
			country_event = { id = socitaly.23 days = 90 random = 240 }
		}
		else_if = {
			limit = { has_idea = SRI_neosanfedisti_2 }
			country_event = { id = socitaly.23 days = 90 random = 1080 }
		}
		if = {
			limit = { has_idea = SRI_neosanfedisti_3 }
			country_event = { id = socitaly.23 days = 90 random = 2160 }
		}
	}
}

