###########################
### Cuban Mella Focuses ###
###########################
###     By Pietrus   	###
###########################

focus_tree = {
	id = CUB_mella_focuses
	country = {
		factor = 0
		modifier = {
			add = 10
			tag = CUB
		}
	}
	default = no
	continuous_focus_position = { x = 550 y = 900 }

	shared_focus = CUB_mella_begin
	shared_focus = CUB_new_economic_expansion
	shared_focus = CUB_foreign_relate
	shared_focus = CUB_begin_mil_reform
}

shared_focus = {
	id = CUB_mella_begin
	icon = GFX_focus_prc_agrarian_socialism
	x = 8
	y = 0
	cost = 1

	available = {
		custom_trigger_tooltip = {
			always = no
			tooltip = bypass8_tooltip
		}
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_begin"
		custom_effect_tooltip = cubanoeffect_tooltip
	}
}

shared_focus = {
	id = CUB_mella_2
	icon = GFX_focus_AUS_agriculture
	x = -5
	y = 1
	relative_position_id = CUB_mella_begin
	cost = 10

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_begin
	}
	mutually_exclusive = {
		focus = CUB_mella_3
	}
	mutually_exclusive = {
		focus = CUB_melraddeal_2
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_2"
		swap_ideas = {
			remove_idea = CUB_extsyndagr_2
			add_idea = CUB_extsyndagr_3
		}
		add_stability = 0.05
	}
	search_filters = { FOCUS_FILTER_MANPOWER FOCUS_FILTER_INDUSTRY FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_mella_3
	icon = GFX_goal_revolution_tools
	x = -3
	y = 1
	relative_position_id = CUB_mella_begin
	cost = 10

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_begin
	}
	mutually_exclusive = {
		focus = CUB_mella_2
	}
	mutually_exclusive = {
		focus = CUB_melraddeal_2
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_3"
		swap_ideas = {
			remove_idea = CUB_extsyndagr_2
			add_idea = CUB_extsyndagr_comp
		}
		add_popularity = {
			ideology = syndicalist
			popularity = -0.05
		}
		add_popularity = {
			ideology = totalist
			popularity = 0.05
		}
	}
	search_filters = { FOCUS_FILTER_MANPOWER FOCUS_FILTER_INDUSTRY }
}

shared_focus = {
	id = CUB_mella_4
	icon = GFX_HOL_crackdown_syndie
	x = -6
	y = 2
	relative_position_id = CUB_mella_begin
	cost = 3

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_2
		focus = CUB_mella_3
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_4"
		add_stability = -0.05
		add_popularity = {ideology = syndicalist popularity = -0.1}
	}
	search_filters = { FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_mella_5
	icon = GFX_goal_HOL_council_communism
	x = -4
	y = 2
	relative_position_id = CUB_mella_begin
	cost = 10

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_2
		focus = CUB_mella_3
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_5"
		315 = {
			add_extra_state_shared_building_slots = 3
		}
		add_popularity = {
			ideology = totalist
			popularity = 0.05
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}

shared_focus = {
	id = CUB_mella_6
	icon = GFX_goal_LIB_reform_judiciary
	x = -2
	y = 2
	relative_position_id = CUB_mella_begin
	cost = 3

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_2
		focus = CUB_mella_3
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_6"
		add_stability = -0.025
		add_ideas = CUB_judicial_reform
		add_political_power = -100
	}
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_mella_7
	icon = GFX_goal_POR_burden_empire
	x = -5
	y = 3
	relative_position_id = CUB_mella_begin
	cost = 8

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_4
	}
	prerequisite = {
		focus = CUB_mella_5
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_7"
		if = {
			limit = {
				has_idea = CUB_sexism
			}
			swap_ideas = {
				remove_idea = CUB_sexism
				add_idea = CUB_mellatranssociety
			}
		}
		else = {
			add_ideas = CUB_racism_outlawed
		}
		add_political_power = -300
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_MANPOWER FOCUS_FILTER_POLITICAL }
}

shared_focus = {
	id = CUB_mella_8
	icon = GFX_ITA_female_soldiers
	x = -3
	y = 3
	relative_position_id = CUB_mella_begin
	cost = 8

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_5
	}
	prerequisite = {
		focus = CUB_mella_6
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_8"
		if = {
			limit = {
				has_idea = CUB_racism_outlawed
			}
			swap_ideas = {
				remove_idea = CUB_racism_outlawed
				add_idea = CUB_mellatranssociety
			}
		}
		else = {
			add_ideas = CUB_sexism
		}
		add_war_support = 0.05
		add_stability = 0.05
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_STABILITY FOCUS_FILTER_WAR_SUPPORT FOCUS_FILTER_MANPOWER FOCUS_FILTER_ARMY_BONUS }
}

shared_focus = {
	id = CUB_mella_9
	icon = GFX_goal_bull
	x = -7
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 5

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_7
	}
	prerequisite = {
		focus = CUB_mella_8
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_9"
		hidden_effect = {
			add_country_leader_trait = el_caballo
		}
		custom_effect_tooltip = cub_mellacaballott
	}
}

shared_focus = {
	id = CUB_mella_10
	icon = GFX_goal_burning_globe
	x = -5
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 5

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_7
	}
	prerequisite = {
		focus = CUB_mella_8
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_10"
		add_ideas = CUB_perm_rev
	}
	search_filters = { FOCUS_FILTER_ANNEXATION }
}

shared_focus = {
	id = CUB_mella_11
	icon = GFX_goal_MAF_Kulturkampf
	x = -3
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 6

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_7
	}
	prerequisite = {
		focus = CUB_mella_8
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_11"
		add_stability = 0.075
		add_political_power = -100
	}
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_mella_12
	icon = GFX_goal_great_science
	x = -1
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 10

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_7
	}
	prerequisite = {
		focus = CUB_mella_8
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_12"
		add_ideas = CUB_education
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}

shared_focus = {
	id = CUB_mella_13
	icon = GFX_focus_generic_strike_at_democracy2
	x = -4
	y = 5
	relative_position_id = CUB_mella_begin
	cost = 10

	available = {
		has_government = totalist
		NOT = {
			has_country_flag = mellaradsocdeal
		}
	}

	prerequisite = {
		focus = CUB_mella_9
	}
	prerequisite = {
		focus = CUB_mella_10
	}
	prerequisite = {
		focus = CUB_mella_11
	}
	prerequisite = {
		focus = CUB_mella_12
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_mella_13"
		add_political_power = 300
		hidden_effect = {
			country_event = {
				id = cuba.233
				days = 90
			}
		}
	}
	search_filters = { FOCUS_FILTER_POLITICAL }
}

shared_focus = {
	id = CUB_melraddeal_2
	icon = GFX_goal_ideology_radical_socialist
	x = 5
	y = 1
	relative_position_id = CUB_mella_begin
	cost = 6

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_mella_begin
	}
	mutually_exclusive = {
		focus = CUB_mella_2
	}
	mutually_exclusive = {
		focus = CUB_mella_3
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_2"
		set_variable = { CUB_socdeal_mella_count = 0 }
		set_variable = { CUB_socdeal_blas_count = 0 }
		country_event = cuba.215
	}
}

shared_focus = {
	id = CUB_melraddeal_3
	icon = GFX_goal_agricultural_aid
	x = 3
	y = 2
	relative_position_id = CUB_mella_begin
	cost = 2

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
		has_country_flag = CUB_melladealtrcomp
	}

	prerequisite = {
		focus = CUB_melraddeal_2
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_3"

		if = {
			limit = {
				has_country_flag = CUB_melstrongarmblasag
			}
			add_popularity = {ideology = totalist popularity = 0.03}
			add_popularity = {ideology = radical_socialist popularity = -0.02}
			swap_ideas = {
				remove_idea = CUB_extsyndagr_2
				add_idea = CUB_extsyndagr_3
			}
		}
		else = {
			add_popularity = {ideology = totalist popularity = -0.02}
			add_popularity = {ideology = radical_socialist popularity = 0.03}
			swap_ideas = {
				remove_idea = CUB_extsyndagr_2
				add_idea = CUB_extsyndagr_4
			}
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_MANPOWER FOCUS_FILTER_POLITICAL }
}

shared_focus = {
	id = CUB_melraddeal_4
	icon = GFX_Socialist_Law
	x = 5
	y = 2
	relative_position_id = CUB_mella_begin
	cost = 7

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
		has_country_flag = CUB_melladealtrcomp
	}

	prerequisite = {
		focus = CUB_melraddeal_2
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_4"

		if = {
			limit = {
				has_country_flag = CUB_melstrongarmblaspol
			}
			add_popularity = {ideology = totalist popularity = 0.03}
			add_popularity = {ideology = radical_socialist popularity = -0.02}
			add_stability = 0.05
		}
		else = {
			add_popularity = {ideology = totalist popularity = -0.02}
			add_popularity = {ideology = radical_socialist popularity = 0.03}
			add_war_support = 0.05
		}
	}
	search_filters = { FOCUS_FILTER_WAR_SUPPORT FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_melraddeal_5
	icon = GFX_goal_agrarian_soldiers
	x = 7
	y = 2
	relative_position_id = CUB_mella_begin
	cost = 7

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
		has_country_flag = CUB_melladealtrcomp
	}

	prerequisite = {
		focus = CUB_melraddeal_2
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_5"

		if = {
			limit = {
				has_country_flag = CUB_melstrongarmblasmil
				has_idea = CUB_militia_idea
			}
			add_popularity = {ideology = totalist popularity = 0.03}
			add_popularity = {ideology = radical_socialist popularity = -0.02}
			swap_ideas = {
				remove_idea = CUB_militia_idea
				add_idea = CUB_militia_idea_3
			}
		}
		if = {
			limit = {
				has_country_flag = CUB_melstrongarmblasmil
				has_idea = CUB_militia_idea_2
			}
			add_popularity = {ideology = totalist popularity = 0.03}
			add_popularity = {ideology = radical_socialist popularity = -0.02}
			swap_ideas = {
				remove_idea = CUB_militia_idea_2
				add_idea = CUB_militia_idea_4
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = CUB_melstrongarmblasmil
				}
				has_idea = CUB_militia_idea
			}
			add_popularity = {ideology = totalist popularity = -0.02}
			add_popularity = {ideology = radical_socialist popularity = 0.03}
			swap_ideas = {
				remove_idea = CUB_militia_idea
				add_idea = CUB_militia_idea_5
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = CUB_melstrongarmblasmil
				}
				has_idea = CUB_militia_idea_2
			}
			add_popularity = {ideology = totalist popularity = -0.02}
			add_popularity = {ideology = radical_socialist popularity = 0.03}
			swap_ideas = {
				remove_idea = CUB_militia_idea_2
				add_idea = CUB_militia_idea_6
			}
		}
		if = {
			limit = {
				NOT = {
					has_idea = CUB_militia_idea
					has_idea = CUB_militia_idea_2
				}
			}
			custom_effect_tooltip = blasmelmil_tt
		}
	}
	search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_MANPOWER }
}

shared_focus = {
	id = CUB_melraddeal_6
	icon = GFX_goal_women_industry
	x = 4
	y = 3
	relative_position_id = CUB_mella_begin
	cost = 5

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_3
	}
	prerequisite = {
		focus = CUB_melraddeal_4
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_6"
		add_political_power = -150
		if = {
			limit = {
				has_completed_focus = CUB_melraddeal_7
			}
			country_event = cuba.216
			add_stability = 0.05
			add_war_support = 0.05
		}
	}
	search_filters = { FOCUS_FILTER_WAR_SUPPORT FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_melraddeal_7
	icon = GFX_goal_POR_burden_empire
	x = 6
	y = 3
	relative_position_id = CUB_mella_begin
	cost = 5

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_4
	}
	prerequisite = {
		focus = CUB_melraddeal_5
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_7"
		add_political_power = -150
		if = {
			limit = {
				has_completed_focus = CUB_melraddeal_6
			}
			country_event = cuba.216
			add_stability = 0.05
			add_war_support = 0.05
		}
	}
	search_filters = { FOCUS_FILTER_WAR_SUPPORT FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_melraddeal_8
	icon = GFX_goal_foreign_diplomacy
	x = 2
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 7

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_6
	}
	prerequisite = {
		focus = CUB_melraddeal_7
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_8"
		add_stability = -0.05
		add_ideas = CUB_socliscences
	}
	search_filters = { FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_melraddeal_9
	icon = GFX_goal_PAP_crusade
	x = 4
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 7

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_6
	}
	prerequisite = {
		focus = CUB_melraddeal_7
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_9"
		add_stability = 0.05
		add_war_support = 0.05
		if = {
			limit = {
				country_exists = PAP
			}
			reverse_add_opinion_modifier = { target = PAP modifier = CUB_anticlericalpushpap }
		}
		if = {
			limit = {
				SRI = {
					exists = yes
					OR = {
						has_government = radical_socialist
						not_has_socialist_government = yes
					}
				}
			}
			reverse_add_opinion_modifier = { target = SRI modifier = CUB_anticlericalpush }
		}
		if = {
			limit = {
				TEX = {
					exists = yes
					has_government = national_populist
				}
			}
			reverse_add_opinion_modifier = { target = TEX modifier = CUB_anticatholicopinion }
		}
		custom_effect_tooltip = cub_anticleric_tt
		every_country = {
			limit = {
				not_has_socialist_government = yes
			}
			hidden_effect = {
				reverse_add_opinion_modifier = { target = SIC modifier = CUB_anticlericalpush }
			}
		}
	}
	search_filters = { FOCUS_FILTER_WAR_SUPPORT FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_melraddeal_10
	icon = GFX_goal_DOM_Call_Special_Election
	x = 6
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 10

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_6
	}
	prerequisite = {
		focus = CUB_melraddeal_7
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_10"
		add_ideas = CUB_longjustblas
	}
	search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_ANNEXATION FOCUS_FILTER_POLITICAL }
}

shared_focus = {
	id = CUB_melraddeal_11
	icon = GFX_goal_generic_dangerous_deal
	x = 8
	y = 4
	relative_position_id = CUB_mella_begin
	cost = 3

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_6
	}
	prerequisite = {
		focus = CUB_melraddeal_7
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_11"
		add_stability = -0.05
		add_political_power = 100
	}
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_STABILITY }
}

shared_focus = {
	id = CUB_melraddeal_12
	icon = GFX_goal_checkmate
	x = 5
	y = 5
	relative_position_id = CUB_mella_begin
	cost = 7

	available = {
		OR = {
			has_government = totalist
			has_government = radical_socialist
		}
		has_country_flag = mellaradsocdeal
	}

	prerequisite = {
		focus = CUB_melraddeal_8
	}
	prerequisite = {
		focus = CUB_melraddeal_9
	}
	prerequisite = {
		focus = CUB_melraddeal_10
	}
	prerequisite = {
		focus = CUB_melraddeal_11
	}

	ai_will_do = {
		factor = 15
	}

	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CUB_melraddeal_12"
		country_event = cuba.214
	}
}
